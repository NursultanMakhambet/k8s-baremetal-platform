---
# Argo CD: install via official manifest (no Helm hooks). Run on control host with kubectl, KUBECONFIG set.
# Only runs when platform_install_argocd is true. Override argocd_install_manifest_url in group_vars to pin a version.

- name: Install Argo CD in argocd namespace (manifest)
  command: >
    kubectl apply -n argocd -f {{ argocd_install_manifest_url }}
  run_once: true
  when: platform_install_argocd | default(false) | bool
  tags: [argocd]
